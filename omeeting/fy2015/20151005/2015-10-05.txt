= 海洋モデルミーティングログ(2015/10/05)

== 参加者(敬称略)

* 林, 中島, 竹広, 高橋, 河合


== 進捗状況の報告(河合)

=== 結合モデルの長時間積分(O(1000) 年)に向けた取り組み

* 結合系の平衡状態を短時間で求める時間積分法を新しく導入した.
  * 手順
    * 1 サイクルの手順
      * [1] 大気・海洋海氷モデルによる結合 run
        * 初期条件: 
      * [2] 海洋海氷モデル単体による run
      * [3] [1] に戻る.
    * 結合系が平衡状態に達するまで上述したサイクルを繰り返す. 
    * 各 run の初期条件の指定
      * [1] 大気モデルは, 1 サイクル前の結合モデル run 終了時の結果を初期の大気場として用いる.
            海洋海氷モデルは, 1 サイクル前の海洋海氷モデル単体 run 終了時の結果を初期の海洋場として
	    用いる.
      * [2] 同じサイクルの結合モデル run 終了時の結果を初期の海洋場として用いる
    * 海洋海氷モデル単体 run における海面境界条件
      * 同じサイクルの結合モデル run の計算結果から時間平均した海面フラックスの分布を作成し, それを
        海洋海氷モデル単体 run の海面境界条件として用いる. 
  * Bash スクリプトと ruby スクリプト(内部で GPhys を使って時間平均などを行う)を組み合わせて, 一連の
    サイクルを自動化した. 
  * 計算時間に関して
    * 例えば, 結合モデル run の時間積分を 6 ヶ月, 海洋海氷モデル run の時間積分を 10 年を行うのならば,
      今利用している計算環境(PC ３台. 大気モデル: 8 プロセス並列(MPI フラット), 海洋モデル: 8 スレッド
      並列)ではおよそ 1 サイクル 45 分ほどで計算できる. 


=== 大気・海洋海氷結合モデルによる水惑星実験

* 大気海洋海氷結合モデルによる水惑星実験を実施する中で, 結合モデルのデバックを行っている.
  * 実験設定
    * 系の設定
      * 水惑星設定, 海底地形なし(水深 5.2 km)
    * モデル
      * 大気モデル(DCPAM)
        * 力学過程
	  * プリミティブ方程式
        * 物理過程
　　　　　* 放射: 地球用放射 (Chou et al 1998; Chou et al, 2001)
	  * 積雲パラメタリゼーション: Relaxed Arakawa Schubert
	  * 地表面フラックス: バルク式(Beljaars and Holtslag, 1991)
	  * 鉛直乱流混合: Mellor and Yamada 2.5 次
	  * 大規模凝結 (Manabe et al., 1965)	  
      * 海洋モデル(今回は軸対称モデルを用いた)
        * 力学過程
	  * ブジネスクプリミティブ方程式
	* 物理過程
	  * メソスケール渦による混合(Gent McWilliams)
	  * 対流調節
     * 初期条件
        * 大気: 温度一様, 静止状態
	* 海洋: 温位, 塩分一様, 静止状態
     * その他
        * 時間ステップ
	  * 大気: 0.5 hour, 海洋: 4 hour
	* 日変化なし, 季節変化なし

* 新しく導入した時間積分法を使って, 水惑星実験を行った.
  * モデル解像度
    * 大気モデル(3D): T21L26
    * 海洋モデル(軸対称): Pl42L60
  * 時間積分に関する設定
    * 結合モデル run は 6 ヶ月, 海洋海氷モデル単体 run は 10 年積分する. 
    * 結合モデル run において, フラックス交換は 4 hour ごとに行う. 
  * 計算結果
    (以下では, サイクル n の結合モデル run のことを Cycle{n}-Coupled, 海洋海氷モデル run のことを
     Cycle{n}-Standalone と呼ぶことにする)
    * 9 サイクル目までは順調に積分が進み大気構造や海洋表層の構造が落ち着きつつあるが, 海氷が極域を
      覆い始めて少しした Cycle10-Coupled (結合モデル 5 年, 海洋海氷モデル単体 100 年程積分したこと
      になる)において, 海氷面温度が激しく振動して, 計算が破綻する. 計算結果を眺めていると, 海面温度
      の時間的な振動は顕熱フラックスの時間的振動と関係があるように見える. 
      * 考えられる原因
        * 海氷モデルにおいて海氷面温度を決めるためにエネルギーバランスを考えるが, 海面フラックス
	  (特に顕熱フラックス)を陰的に取り扱っていない. そのため数値不安定が起こっているのではないか?

* 大気・海洋モデル間のフラックス交換時の補間計算の検証
  * 現在用いている補間計算法
    * 線形補間, エネルギー保存は非保証. 
  * 補間計算に伴うフラックスの全球平均値のずれを, 上述した水惑星実験の結果(Cycle7-Standalone)において
    調べてみた. 
  * 正味では 1~2 W/m2 ずれていることが分かった.  

* 海洋モデル(&海氷モデル)におけるエネルギー収支の確認に向けた取り組み
  * 海洋モデルのエネルギー収支を確認するために, 最初に Vallis(2006) や Tailleux(2013) 等を参考にして
    海洋モデルの支配方程式からエネルギー方程式を導出した.
  * エネルギー方程式の各項の鉛直積分値や全球積分値を計算する解析プログラムを作成中である.
    * 運動エネルギーの方程式を解析するプログラムは完成した.
  * 今後の方針
    * Tailleux(2013) で定義される有効位置エネルギーによるエネルギー収支の考察は有益かもしれないが理解に
      時間がかかりそうなので, まずはより簡単な海洋モデルのエネルギー収支の確認(海面から海洋モデルに注入
      された熱エネルギーなど)を優先して行う. 
  
* TODO
  * 海氷モデルと関係した数値不安定の問題を解決し, 結合系が平衡状態に至るまでの水惑星実験を実施する.
    * まずは, 海氷面のエネルギーバランスの計算において, 海面フラックスの表面温度依存性を陰的に取り扱う
      ようにする.
    * それでも数値不安定の問題が解決しない場合は, 部分氷や海氷の厚さの水平拡散の導入を検討してみる. 
  * 太陽定数依存性の調査に向けた全球氷なし解, 全球凍結解の探索
  * エネルギー保存を満たす補間法の調査と実装


=== 対流調節スキームの調査と導入

* TODO
  *「遅い」対流調節の計算結果とそれと等価な拡散方程式の数値解の比較をノートに追加する. 
  * 対流調節前後で, 温位, 塩分の鉛直コラム内での保存性を確認

=== 中規模渦パラメタリゼーション(Redi スキーム, GM スキーム) 

* TODO
  * GM スキームの解釈図を, 簡単な関形数を考えて描いてみる.
  
=== 全体的な TODO

* 大気海洋氷結合モデルによる水惑星実験の最近の研究の調査
* 海洋海氷モデルの開発に関して後回しにしたこと
  * 海氷の厚さの拡散の導入
    * 海氷の力学を第一次近似で表現したことになる.
  * rigid lid 近似の排除と自由表面(線形)の導入(Marshall et al., 1997)

== 次回予定日

*  11/10(火) 12:30 から


