#+TITLE: 水惑星設定におけ風成循環の数値実験
#+AUTOHR: 河合 佑太
#+LANGUAGE: ja
#+OPTIONS: H:2
#+HTML_MATHJAX: align:"left" mathml:t path:"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></SCRIPT>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="./../org.css" />

#+NAME: create_FigsTable
#+BEGIN_SRC ruby ::results value raw :exports none :var caption="ほほげほげ" :var figPicsPath="hoge1.png,hoge2.png" :var dirPath="./"
    require 'pathname'

    str = "#+CAPTION: #{caption}.\n" << "|"

    figPicPathStrs = figPicsPath.split(",")
    figPicPathStrs.each{|figPath|
      figThumbPath = Pathname(figPath).sub(/\.[^.]+$/,  "_thumb.png")
      str << "[[file:#{dirPath}#{figPath}][file:#{dirPath}#{figThumbPath}]] |"
    }
    str << "\n"
    return str
#+END_SRC


* 概要
  水惑星設定(陸・地形なし)の静止した海洋に対して, 東西一様な海面応力場を与え, 
  どのような循環が駆動されるかをシミュレーションする. 

  地球では偏西風や貿易風の海面応力によって, エクマン層を介して循環が駆動される. 
  hogehoge

  
* 実験設定

** ケース間で共通な設定

*** 計算領域

- 全球的に広がる水深 5.3 km の海洋. 
  海底地形や陸は存在しない.  


*** 基本成層場

  温位の気候値データの水平平均を与える. 

*** 散逸
- 水平渦粘性係数
  
  次の各ケース設定を参照.   
  
- 鉛直渦粘性係数

  海面の流速が Marshall, et al. (2007) と同程度になるように, $A_v=1.0 \times 10^{-2}$ [m^2 s^{-1}] にとる. 

*** 海水の状態方程式

- 線形(Vallis, 2006)


*** 初期条件  

- 運動場: 静止状態
- 温位の摂動場: 摂動なし
- 塩分は空間一様を仮定

*** 境界条件

- 海面応力

  Marshall, et al. (2007) における準平衡状態での地表風速から計算された, 
  海面応力の東西平均場を与える.  

- 海面, 海底における熱的条件: 断熱
- 海面における淡水フラックス: なし


  #+CAPTION: 海面応力および温位の基本場の分布. 
  | [[./data/common/windStressLon.jpg][file:./data/common/windStressLon_thumb.png]]    | [[./data/common/z_PTempBasic.jpg][file:./data/common/z_PTempBasic_thumb.png]]    |


** 各ケース設定

   #+CAPTION: Ah:水平渦粘性係数[m^2 s^{-1}]. 
  | 実験名              | 解像度　 | Ah              |
  |---------------------+----------+-----------------|
  | Ah800L20 (標準実験) | T21L20   | 8.0 \times 10^2 |
  | Ah800L60            | T21L60   | 8.0 \times 10^2 |
  | Ah400L20            | T21L20   | 4.0 \times 10^2 |
  | Ah1600L20           | T21L20   | 1.6 \times 10^3 |
   

- ケース Ah800L20 は, 鉛直解像度および水平渦粘性係数の依存性を調べるための標準実験である. 
  - 水平渦粘性係数 $A_h=800$ [m^2 s^{-1}] の値は, Marshall, et al(2007) で使われている
    中規模渦パラメタリゼーション(Gent and McWilliams, 1990)の輸送係数を参考に決定[fn:AbouthEddCoef]. 

[fn:AbouthEddCoef] Marshall, et al. の計算の水平解像度の方が 1.5 倍ほど高いため, ここではより大きな Ah をとるべきかもしれない. しかし, GM スキームとここでの粗野な水平拡散の取り扱いには差があり, 自明に拡散係数の値を設定するのは難しいと思われたので, 
同じ値にした. 


- 鉛直解像度の依存性は, Ah800L20 と Ah800L60 の計算結果の比較によって調べる. 
- 水平渦粘性係数の依存性は, Ah400L20, Ah800L20, Ah1600L20  間の計算結果の比較によって調べる. 

* 計算結果
　
** 標準実験

*** 東西流速, 子午面循環

 #+CALL: create_FigsTable("左から順に, 東西流速の海面分布の時間発展([m]), t=25yr における東西流速([m]), 質量流線関数([m^2/s])の子午面分布, 運動エネルギーの全球平均の時間発展[m^2/(s*kg)]", "xy_U_SeaSurf.jpg,yz_U_mplane.jpg,yz_MassStreamFunc_mplane.jpg,t_EnergyBudget.jpg","./data/exp_Ah800L20/") :results value raw :exports results

- 東西流
  - 海面応力と同じ方向の流れ. 中緯度:西向き, 低緯度: 東向き. 
  - 東西流速の大きさの順圧的な成分は海面応力によって決定される.  
  - 東西流速の傾圧的な成分は, 南北方向の温度勾配を反映している(温度風平衡). 

- 子午面循環
  - 境界近傍のエクマン層によって, 低緯度, 中緯度に 2 つの循環セルが生じる. 
    - 南北流
      - 海面近く:　低緯度では極向き, 中高緯度では赤道向き
      - 海底近く:　海面近くの南北流と同程度の大きさで, 向きが逆. 
    - 鉛直流: 赤道帯/高緯度域で上昇, 中緯度域で下降する.  
  - 内部域では南北流は東西流速と比べ非常に小さい.
　- 鉛直方向に対してギブス振動が見受けられる. 鉛直解像度依存性を参照. 

- 運動エネルギー 
  - この時間積分の時間スケール(25 年間)では, 系は定常に達さない. 

*** 温位(偏差)

 #+CALL: create_FigsTable(" t=25yr における温位偏差([K])の子午面分布", "yz_PTempEdd_mplane.jpg", "./data/exp_Ah800L20/") :results value raw :exports results

- 鉛直流の南北分布を反映し, 温度偏差は赤道帯の上昇域では負, 中緯度の下降域では正である. 

*** 圧力

hogehoge

** 鉛直解像度の依存性(ケース Ah800L20, Ah800L60 の結果の比較)

*** ケース間での数値解の変化について

- 海面東西流の比較 

 #+CALL: create_FigsTable("海面東西流[m]の時間発展(左から順に Ah800L20, Ah800L60), 運動エネルギー[m^2/(s^2*kg)] の全球平均値の時間発展(破線:Ah800L20, 実線:Ah800L60)の比較. ", "exp_Ah800L20/xy_U_SeaSurf.png,exp_Ah800L60/xy_U_SeaSurf.png,LCompare/KEAvg_LCompari.png", "./data/") :results value raw :exports results

- 質量流線関数の比較

 #+CALL: create_FigsTable(" t=25 yr の質量流線関数[kg*m^2/s]の子午面分布(左から順に Ah800L20, Ah800L60)の比較. ", "exp_Ah800L20/yz_MassStreamFunc_mplane.png,exp_Ah800L60/yz_MassStreamFunc_mplane.png", "./data/") :results value raw :exports results

- 温度偏差の比較

 #+CALL: create_FigsTable(" t=25yr における温位偏差[K]の子午面分布の比較.", "exp_Ah800L20/yz_PTempEdd_mplane.jpg,exp_Ah800L60/yz_PTempEdd_mplane.jpg", "./data/") :results value raw :exports results

*** ギブス振動について
- hogehoge


** 水平渦粘性係数の依存性(ケース Ah400L20, Ah800L20, Ah1600L20 間の比較)

*** ケース間での数値解の変化について

- 海面東西流の比較

 #+CALL: create_FigsTable("海面東西流[m]の時間発展(左から順に Ah400L20, Ah800L20, Ah1600L20)の比較", "exp_Ah400L20/xy_U_SeaSurf.jpg,exp_Ah800L20/xy_U_SeaSurf.jpg,exp_Ah1600L20/xy_U_SeaSurf.jpg", "./data/") :results value raw :exports results


- 質量流線関数の比較

 #+CALL: create_FigsTable(" t=25 yr の質量流線関数[kg*m^2/s]の子午面分布(左から順に Ah400L20, Ah800L20, Ah1600L20)の比較", "exp_Ah400L20/yz_MassStreamFunc_mplane.png,exp_Ah800L20/yz_MassStreamFunc_mplane.png,exp_Ah1600L20/yz_MassStreamFunc_mplane.png", "./data/") :results value raw :exports results

- 温度偏差の比較

 #+CALL: create_FigsTable(" t=25yr における温位偏差[K]の子午面分布(左から順に Ah400L20, Ah800L20, Ah1600L20)の比較", "exp_Ah400L20/yz_PTempEdd_mplane.jpg,exp_Ah800L20/yz_PTempEdd_mplane.jpg,exp_Ah1600L20/yz_PTempEdd_mplane.jpg", "./data/") :results value raw :exports results

*** 運動エネルギーの収支解析

- 運動エネルギーの全球平均値の比較

 #+CALL: create_FigsTable(" 運動エネルギーの全球平均値(実線:Ah400L20, 破線:Ah800L20, 点線:Ah1600L20)の比較", "KEAvg_AhCompari.png", "./data/AhCompare/") :results value raw :exports results

- 運動エネルギーの収支解析とその比較

 #+CALL: create_FigsTable(" 運動エネルギーの全球平均値の収支解析(左から順に Ah400L20, Ah800L20, Ah1600L20)の比較. 各図における線は, 上から順に運動エネルギーの注入率, 移流項の仕事, 正味の変化率, 水平拡散による散逸, ポテンシャルエネルギーへの変換, 鉛直拡散による散逸を表す", "exp_Ah400L20/KEBudget.png,exp_Ah800L20/KEBudget.png,exp_Ah1600L20/KEBudget.png", "./data/") :results value raw :exports results

* 考察
- hogehoge

* 参考文献
